<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Editable Map</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
    integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
    crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
    integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
    crossorigin=""></script>
  <!--script
    src="https://code.jquery.com/jquery-3.6.0.js"
    integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script-->

  <style>
    #map {
      position: relative;
      width: 100%;
      height: 700px;
      left: 0;
      top: 0;
    }
  </style>
    
</head>

<body>

  <div id="map"></div>

  <script>

    /**
     * Helper function to create a button with the specified text and click event handler.
     * @param text The text for the button.
     * @param onClick The click event handler for the button.
     * @returns The button.
     */
    function createButton(text, onClick) {
      var b = document.createElement("button");
      b.appendChild(document.createTextNode(text));
      b.addEventListener("click", onClick);
      return b;
    }

    // create map
    var map = L.map("map", {
      center: [41.783, -87.621],
      zoom: 5,
    });

    // add tiles to map
    var tiles = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "Â© OpenStreetMap"
    }).addTo(map);


    function getMarkerPopup(label, marker) {
      var contentDiv = document.createElement("div");
      contentDiv.appendChild(document.createTextNode(label));
      contentDiv.appendChild(createButton("Remove", () => marker.removeFrom(map)));
      return contentDiv;
    }

    function onMapClick(e) {

      var onClickPopup = L.popup({
        keepInView: true, // prevent user from panning the popup out of view
      });

      // Add marker button
      var cancelButton = createButton("Cancel", () => map.closePopup(onClickPopup));
      var addMarkerButton = createButton(
        "Add Marker",
        () => {
          map.closePopup(onClickPopup);
          //var newPopup = L.popup().setContent(getMarkerPopup("test", marker));
          var marker = L.marker(e.latlng)
            .addTo(map);
          marker.bindPopup(getMarkerPopup("test", marker));
        }
      );
      var promptDiv = document.createElement("div");
      promptDiv.appendChild(document.createTextNode("Add a marker to the map at this location?"))
      promptDiv.appendChild(cancelButton);
      promptDiv.appendChild(addMarkerButton);

      onClickPopup
        .setLatLng(e.latlng)
        .setContent(promptDiv)
        .openOn(map);
    }

    map.on("click", onMapClick);

  </script>   

</body>

</html>
<!-- reference: https://github.com/Leaflet/Leaflet/tree/main/docs/examples (BSD 2-Clause License) -->